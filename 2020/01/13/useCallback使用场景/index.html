<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="utf-8">
  

  
  <title>useCallbackä½¿ç”¨åœºæ™¯è¯´æ˜å’Œä¸¾æ — | å–µå–µç„çš„blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="ä½¿ç”¨ react hooks æ—¶, çˆ¶ç»„ä»¶å‘å­ç»„ä»¶ä¼ é€’å‡½æ•° æˆ– åœ¨ useEffect ä¸­ä½¿ç”¨å¤–éƒ¨å‡½æ•°, å¦‚æœä¸åšä»»ä½•å¤„ç†ä¼šå‡ºç° ç»„ä»¶é‡å¤æ¸²æŸ“ æˆ– useEffect ä¸­çš„é€»è¾‘è¢«ä¸åœè§¦å‘çš„æƒ…å†µ, ä¸€èˆ¬è¿™ä¸ªæ—¶å€™ react-hooks çš„ lint ä¹Ÿä¼šæŠ¥é”™ã€‚è¿™ç§æƒ…å†µå¯ä»¥ä½¿ç”¨ useCallback æ¥å°†åŸå‡½æ•°åŒ…è£…ä¸€å±‚å†ä¼ åˆ°éœ€è¦ç”¨çš„åœ°æ–¹, é¿å…å¼‚å¸¸æƒ…å†µã€‚   æœ¬æ–‡ä»‹ç»äº†ä»€ä¹ˆæ—¶å€™åº”è¯¥ä½¿ç”¨ useCa">
<meta property="og:type" content="article">
<meta property="og:title" content="useCallbackä½¿ç”¨åœºæ™¯è¯´æ˜å’Œä¸¾æ —">
<meta property="og:url" content="http://miaomiaoxuan.cn/2020/01/13/useCallbackä½¿ç”¨åœºæ™¯/index.html">
<meta property="og:site_name" content="å–µå–µç„çš„blog">
<meta property="og:description" content="ä½¿ç”¨ react hooks æ—¶, çˆ¶ç»„ä»¶å‘å­ç»„ä»¶ä¼ é€’å‡½æ•° æˆ– åœ¨ useEffect ä¸­ä½¿ç”¨å¤–éƒ¨å‡½æ•°, å¦‚æœä¸åšä»»ä½•å¤„ç†ä¼šå‡ºç° ç»„ä»¶é‡å¤æ¸²æŸ“ æˆ– useEffect ä¸­çš„é€»è¾‘è¢«ä¸åœè§¦å‘çš„æƒ…å†µ, ä¸€èˆ¬è¿™ä¸ªæ—¶å€™ react-hooks çš„ lint ä¹Ÿä¼šæŠ¥é”™ã€‚è¿™ç§æƒ…å†µå¯ä»¥ä½¿ç”¨ useCallback æ¥å°†åŸå‡½æ•°åŒ…è£…ä¸€å±‚å†ä¼ åˆ°éœ€è¦ç”¨çš„åœ°æ–¹, é¿å…å¼‚å¸¸æƒ…å†µã€‚   æœ¬æ–‡ä»‹ç»äº†ä»€ä¹ˆæ—¶å€™åº”è¯¥ä½¿ç”¨ useCa">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="https://i.loli.net/2020/01/13/IfpheSAgVvOjxDl.gif">
<meta property="og:image" content="https://i.loli.net/2020/01/13/fw2PG4V8AvoEtqX.gif">
<meta property="og:image" content="https://i.loli.net/2020/01/13/9YkNGWohZicHn3B.gif">
<meta property="og:image" content="https://i.loli.net/2020/01/13/AXG6dRY8rVjscan.gif">
<meta property="og:updated_time" content="2020-02-17T09:55:29.959Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="useCallbackä½¿ç”¨åœºæ™¯è¯´æ˜å’Œä¸¾æ —">
<meta name="twitter:description" content="ä½¿ç”¨ react hooks æ—¶, çˆ¶ç»„ä»¶å‘å­ç»„ä»¶ä¼ é€’å‡½æ•° æˆ– åœ¨ useEffect ä¸­ä½¿ç”¨å¤–éƒ¨å‡½æ•°, å¦‚æœä¸åšä»»ä½•å¤„ç†ä¼šå‡ºç° ç»„ä»¶é‡å¤æ¸²æŸ“ æˆ– useEffect ä¸­çš„é€»è¾‘è¢«ä¸åœè§¦å‘çš„æƒ…å†µ, ä¸€èˆ¬è¿™ä¸ªæ—¶å€™ react-hooks çš„ lint ä¹Ÿä¼šæŠ¥é”™ã€‚è¿™ç§æƒ…å†µå¯ä»¥ä½¿ç”¨ useCallback æ¥å°†åŸå‡½æ•°åŒ…è£…ä¸€å±‚å†ä¼ åˆ°éœ€è¦ç”¨çš„åœ°æ–¹, é¿å…å¼‚å¸¸æƒ…å†µã€‚   æœ¬æ–‡ä»‹ç»äº†ä»€ä¹ˆæ—¶å€™åº”è¯¥ä½¿ç”¨ useCa">
<meta name="twitter:image" content="https://i.loli.net/2020/01/13/IfpheSAgVvOjxDl.gif">
  
    <link rel="alternate" href="/atom.xml" title="å–µå–µç„çš„blog" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
</head>
</html>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">å–µå–µç„çš„blog</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">miaomiaoxuan&#39;s blog</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="æœç´¢"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://miaomiaoxuan.cn"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-useCallbackä½¿ç”¨åœºæ™¯" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/01/13/useCallbackä½¿ç”¨åœºæ™¯/" class="article-date">
  <time datetime="2020-01-13T12:44:52.000Z" itemprop="datePublished">2020-01-13</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/React/">React</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      useCallbackä½¿ç”¨åœºæ™¯è¯´æ˜å’Œä¸¾æ —
    </h1>
  

      </header>
    
      <div class="article-entry" itemprop="articleBody">
          
              <blockquote>
<p>ä½¿ç”¨ react hooks æ—¶, çˆ¶ç»„ä»¶å‘å­ç»„ä»¶ä¼ é€’å‡½æ•° æˆ– åœ¨ useEffect ä¸­ä½¿ç”¨å¤–éƒ¨å‡½æ•°, å¦‚æœä¸åšä»»ä½•å¤„ç†ä¼šå‡ºç° ç»„ä»¶é‡å¤æ¸²æŸ“ æˆ– useEffect ä¸­çš„é€»è¾‘è¢«ä¸åœè§¦å‘çš„æƒ…å†µ, ä¸€èˆ¬è¿™ä¸ªæ—¶å€™ react-hooks çš„ lint ä¹Ÿä¼šæŠ¥é”™ã€‚è¿™ç§æƒ…å†µå¯ä»¥ä½¿ç”¨ useCallback æ¥å°†åŸå‡½æ•°åŒ…è£…ä¸€å±‚å†ä¼ åˆ°éœ€è¦ç”¨çš„åœ°æ–¹, é¿å…å¼‚å¸¸æƒ…å†µã€‚  </p>
<p>æœ¬æ–‡ä»‹ç»äº†ä»€ä¹ˆæ—¶å€™åº”è¯¥ä½¿ç”¨ useCallback, useCallback å¦‚ä½•å’Œ React.memo() é…åˆä½¿ç”¨, å¹¶é™„ä¸Šç¤ºä¾‹ä»£ç åŠgifæˆªå±, æ–¹ä¾¿æ›´ç›´è§‚çš„ç†è§£ã€‚  </p>
</blockquote>
<a id="more"></a>

<h2 id="åŸºæœ¬ç”¨æ³•"><a href="#åŸºæœ¬ç”¨æ³•" class="headerlink" title="åŸºæœ¬ç”¨æ³•"></a>åŸºæœ¬ç”¨æ³•</h2><p>æŠŠä½ è¦çš„å‡½æ•°ç”¨ useCallback åŒ…ä¸€å±‚, å®šä¹‰å¥½åªæœ‰ä»€ä¹ˆå‚æ•°å˜åŒ–æ—¶, è¿™ä¸ªè¢«åŒ…è¿‡çš„å‡½æ•°æ‰éœ€è¦æ›´æ–°</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> yourfunc = useCallback(</span><br><span class="line">	() =&gt; &#123;</span><br><span class="line">	<span class="comment">// ä½ è¦å†™çš„å‡½æ•°é€»è¾‘</span></span><br><span class="line">	</span><br><span class="line">	&#125;, [</span><br><span class="line">		<span class="comment">// åœ¨æ•°ç»„é‡Œå®šä¹‰ä»€ä¹ˆå‚æ•°æ”¹å˜æ—¶æ‰éœ€è¦æ›´æ–° yourfunc,</span></span><br><span class="line">		<span class="comment">// åªè¦è¿™é‡Œçš„ä¾èµ–çš„å‚æ•°æ²¡æœ‰å˜å¯¹äºä»»ä½•ä½¿ç”¨å®ƒçš„ä¸€æ–¹å®ƒéƒ½æ²¡æœ‰å˜</span></span><br><span class="line">	]</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<h2 id="ä½¿ç”¨åœºæ™¯"><a href="#ä½¿ç”¨åœºæ™¯" class="headerlink" title="ä½¿ç”¨åœºæ™¯"></a>ä½¿ç”¨åœºæ™¯</h2><p>1.çˆ¶ç»„ä»¶å‘å­ç»„ä»¶ä¼ é€’å‡½æ•°æ—¶, é˜»æ­¢ä¼ é€’çš„å‡½æ•°åœ¨æ¯æ¬¡ render æ—¶é‡æ–°åˆ›å»ºï¼Œä»è€Œé€ æˆå­ç»„ä»¶ rerenderã€‚éœ€è¦é…åˆ React.memo() ä¸€èµ·ä½¿ç”¨ã€‚</p>
<p>2.åœ¨ useEffectï¼ˆï¼‰ ä¸­ä½¿ç”¨å¤–éƒ¨åˆ›å»ºçš„å‡½æ•°, ä½†ä¸å¸Œæœ›è¿™ä¸ªå‡½æ•°ä¸€ç›´å˜åŒ–, å¯¼è‡´ useEffect è¢«é‡å¤è§¦å‘ã€‚</p>
<h2 id="æ —å­ğŸŒ°"><a href="#æ —å­ğŸŒ°" class="headerlink" title="æ —å­ğŸŒ°"></a>æ —å­ğŸŒ°</h2><p>1.çˆ¶ç»„ä»¶ä¼ é€’å‡½æ•°ç»™å­ç»„ä»¶</p>
<p>ä½¿ç”¨ useCallback å‰ï¼Œçˆ¶ç»„ä»¶ç›´æ¥ä¼ å‡½æ•°ç»™å­ç»„ä»¶çš„æ–¹å¼ã€‚æ¯æ¬¡ app render æ—¶, ä¼ é€’çš„å‡½æ•° () =&gt; setCount(count + 1) éƒ½ä¼šé‡æ–°åˆ›å»ºä¸€æ¬¡ã€‚æ¯æ¬¡ç‚¹å‡» hello æŒ‰é’®ï¼Œéƒ½ä¼šè¿›è¡Œ renderã€‚</p>
<p><img src="https://i.loli.net/2020/01/13/IfpheSAgVvOjxDl.gif" alt="usecallback_lamda_props_rerender.gif"></p>
<p>ä¸Šå›¾ log æ˜¯æ‰“åœ¨å­ç»„ä»¶ &lt;Hello /&gt; ä¸­çš„, ä»logå¯ä»¥çœ‹åˆ°, æ¯æ¬¡ç‚¹å‡»æŒ‰é’®éƒ½ä¼šé€ æˆå­ç»„ä»¶ rerenderã€‚</p>
<ul>
<li><p>ä½¿ç”¨ useCallback  å‰çš„çˆ¶ç»„ä»¶</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123; useState &#125; <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"><span class="keyword">import</span> &#123; Hello &#125; <span class="keyword">from</span> <span class="string">'./hello'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">Counter</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> [count, setCount] = useState(<span class="number">0</span>)</span><br><span class="line">	  <span class="comment">// éœ€è¦æ³¨æ„, æ¯æ¬¡ render ä¼ é€’çš„å‡½æ•°éƒ½ä¼šé‡æ–°ç”Ÿæˆ</span></span><br><span class="line">	  <span class="comment">// ä¹Ÿå°±æ˜¯ä¸‹é¢çš„ () =&gt; setCount(count + 1)</span></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        &lt;div&gt;</span><br><span class="line">            &lt;Hello increment=&#123;() =&gt; setCount(count + <span class="number">1</span>)&#125; /&gt;</span><br><span class="line">            &lt;div&gt;count: &#123;count&#125;&lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">        &lt;/</span>div&gt;</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>å­ç»„ä»¶<br>å­ç»„ä»¶ä¸­ React.memo() çš„ä½œç”¨ç±»ä¼¼äº class ç»„ä»¶ä¸­çš„ shouldComponentUpdate, ä¼šå¯¹ç»„ä»¶æ¥å—åˆ°çš„ propsè¿›è¡Œæµ…æ¯”è¾ƒ, å¦‚æœ props æ²¡æœ‰å‘ç”Ÿå˜åŒ–ï¼Œç»„ä»¶å°±ä¸ä¼š rerender.</p>
</li>
</ul>
<p>å¦‚æœè¿™é‡ŒæŠŠ React.memo() å»æ‰, é‚£å³ä½¿çˆ¶ç»„ä»¶ä½¿ç”¨ useCallback æ”¹å†™ã€‚å­ç»„ä»¶ <hello> è¿˜æ˜¯ä¼š rerenderã€‚</hello></p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123; useRef &#125; <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨ React.memo ä½¿ç»„ä»¶ä»…åœ¨ props æ›´æ–°æ—¶æ›´æ–°</span></span><br><span class="line"><span class="comment">// æœªä½¿ç”¨ useCallback æ—¶, ç”±äºæ¯æ¬¡ä¼ é€’è¿‡æ¥çš„ increment æ¥åˆ°çš„å‡½æ•°éƒ½ä¼šæ›´æ–°, å­ç»„ä»¶æ¯æ¬¡éƒ½ä¼šrerender</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> Hello = React.memo(<span class="function">(<span class="params">&#123; increment &#125;</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// ä¸‹é¢ä¸¤å¥ç”¨æ¥æŸ¥çœ‹ç»„ä»¶æ›´æ–°çš„æ¬¡æ•°</span></span><br><span class="line">    <span class="keyword">const</span> renderCount = useRef(<span class="number">0</span>)</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'render count:'</span>, renderCount.current++)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> &lt;button onClick=&#123;increment&#125;&gt;hello&lt;/button&gt;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>ä½¿ç”¨ useCallback æ”¹å†™çˆ¶ç»„ä»¶å, æ¯æ¬¡æ›´æ–°æ•°æ®ç»„ä»¶ä¸å†é‡æ–°æ¸²æŸ“, å¦‚å›¾<br><img src="https://i.loli.net/2020/01/13/fw2PG4V8AvoEtqX.gif" alt="usecallback_prevent_rerender.gif"></p>
<ul>
<li>ä½¿ç”¨ useCallback æ”¹å†™åŸçˆ¶ç»„ä»¶, å­ç»„ä»¶ä¸éœ€è¦ä¿®æ”¹<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123; useState, useCallback &#125; <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"><span class="keyword">import</span> &#123; Hello &#125; <span class="keyword">from</span> <span class="string">'./hello'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">Counter</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> [count, setCount] = useState(<span class="number">0</span>)</span><br><span class="line">    </span><br><span class="line">	  <span class="comment">// useCallback ä»…å°† setCount ä½œä¸ºä¾èµ–, åªè¦ setCount ä¸æ”¹å˜,</span></span><br><span class="line">	  <span class="comment">// increment å‡½æ•°å°±ä¸ä¼šæ”¹å˜</span></span><br><span class="line">	  <span class="comment">// ç›¸åº”çš„å­ç»„ä»¶æ¥å—åˆ°çš„ props æ²¡æ”¹å˜, å°±ä¸ä¼š rerender</span></span><br><span class="line">    <span class="keyword">const</span> increment = useCallback(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        setCount(<span class="function"><span class="params">prevCount</span> =&gt;</span> prevCount + <span class="number">1</span>)</span><br><span class="line">    &#125;, [setCount])</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        &lt;div&gt;</span><br><span class="line">            &lt;Hello increment=&#123;increment&#125; /&gt;</span><br><span class="line">            &lt;div&gt;count: &#123;count&#125;&lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">        &lt;/</span>div&gt;</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<ol start="2">
<li>ä½¿ç”¨ map æ¸²æŸ“å¤šä¸ªå­ç»„ä»¶å¹¶ä¼ é€’å‡½æ•°ç»™å®ƒä»¬</li>
</ol>
<p>ä¸‹é¢çš„è®¡æ•°å™¨å°†ä¸€ä¸ªæ•°å­—æ„æˆçš„æ•°ç»„æ¸²æŸ“æˆå¤šä¸ªæŒ‰é’®, ç‚¹å‡»æŒ‰é’®ç»™ count å¢åŠ ç›¸åº”çš„å€¼ã€‚ä¸ä¸Šé¢çš„ä¾‹å­ä¸åŒçš„æ˜¯, è¿™é‡Œçš„ increment éœ€è¦ä¼ å…¥å¯¹åº”çš„æ•°å­—, è¿›è¡Œç›¸åº”è®¡æ•°ã€‚æ”¾ä¸Šè¿™ä¸ªä¾‹å­æ˜¯ä¸ºäº†è¯´æ˜, å¦‚æœ å­ç»„ä»¶è¦æ‰§è¡Œçš„å‡½æ•° å’Œ å‡½æ•°è¦ç”¨åˆ°çš„å‚æ•° éƒ½æ˜¯çˆ¶ç»„ä»¶æä¾›çš„, æœ€å¥½æŠŠäºŒè€…éƒ½ä¼ é€’ç»™å­ç»„ä»¶åœ¨å­ç»„ä»¶æ‰§è¡Œã€‚</p>
<p>æ”¹å†™å‰ç‚¹å‡»è®¡æ•°æˆªå›¾<br><img src="https://i.loli.net/2020/01/13/9YkNGWohZicHn3B.gif" alt="usecallback_map_rerender.gif"> </p>
<ul>
<li><p>ä¼šé€ æˆ rerender çš„çˆ¶ç»„ä»¶å‡½æ•°ä¼ é€’æ–¹å¼</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123; useState, useCallback &#125; <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"><span class="keyword">import</span> &#123; Num &#125; <span class="keyword">from</span> <span class="string">'./numbers'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">Counter</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> [count, setCount] = useState(<span class="number">0</span>)</span><br><span class="line">    <span class="keyword">const</span> nums = [<span class="number">3</span>, <span class="number">33</span>, <span class="number">333</span>]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> increment = useCallback(<span class="function"><span class="params">n</span> =&gt;</span> &#123;</span><br><span class="line">        setCount(<span class="function"><span class="params">prevCount</span> =&gt;</span> prevCount + n)</span><br><span class="line">    &#125;, [setCount])</span><br><span class="line">	</span><br><span class="line">	  <span class="comment">// ä¼ é€’ () =&gt; increment(n), è€Œä¸æ˜¯ç›´æ¥ä¼ é€’ increment</span></span><br><span class="line">	  <span class="comment">// ä»ç„¶ä¼šé€ æˆæ¯æ¬¡ render ç”Ÿæˆä¸€ä¸ªæ–°çš„å‡½æ•°</span></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        &lt;div&gt;</span><br><span class="line">            &#123;</span><br><span class="line">                nums.map(<span class="function"><span class="params">n</span> =&gt;</span></span><br><span class="line">                    &lt;Num</span><br><span class="line">                        onClick=&#123;() =&gt; increment(n)&#125;</span><br><span class="line">                        n=&#123;n&#125;</span><br><span class="line">                        key=&#123;n&#125;</span><br><span class="line">                    /&gt;</span><br><span class="line">                )</span><br><span class="line">            &#125;</span><br><span class="line">            &lt;div&gt;count: &#123;count&#125;&lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">        &lt;/</span>div&gt;</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>ç›¸åº”çš„å­ç»„ä»¶ç›´æ¥è°ƒç”¨ onClick</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123; useRef &#125; <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> Num = React.memo(<span class="function">(<span class="params">&#123; onClick, n &#125;</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// ä»¥ä¸‹ä¸¤å¥ç”¨æ¥æŸ¥çœ‹ç»„ä»¶æ›´æ–°çš„æ¬¡æ•°</span></span><br><span class="line">    <span class="keyword">const</span> renderCount = useRef(<span class="number">0</span>)</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'render count:'</span>, renderCount.current++)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> &lt;button onClick=&#123;onClick&#125;&gt;&#123;n&#125;&lt;/button&gt;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

</li>
</ul>
<p>æ”¹å†™åç‚¹å‡»è®¡æ•°æˆªå›¾<br><img src="https://i.loli.net/2020/01/13/AXG6dRY8rVjscan.gif" alt="usecallback_prevent_map_rerender.gif"></p>
<ul>
<li>æ”¹å†™åçš„ çˆ¶ç»„ä»¶<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123; useState, useCallback &#125; <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"><span class="keyword">import</span> &#123; Num &#125; <span class="keyword">from</span> <span class="string">'./numbers'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">Counter</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> [count, setCount] = useState(<span class="number">0</span>)</span><br><span class="line">    <span class="keyword">const</span> nums = [<span class="number">3</span>, <span class="number">33</span>, <span class="number">333</span>]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> increment = useCallback(<span class="function"><span class="params">n</span> =&gt;</span> &#123;</span><br><span class="line">        setCount(<span class="function"><span class="params">prevCount</span> =&gt;</span> prevCount + n)</span><br><span class="line">    &#125;, [setCount])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        &lt;div&gt;</span><br><span class="line">            &#123;</span><br><span class="line">                nums.map(<span class="function"><span class="params">n</span> =&gt;</span></span><br><span class="line">                    &lt;Num</span><br><span class="line">                        increment=&#123;increment&#125;</span><br><span class="line">                        n=&#123;n&#125;</span><br><span class="line">                        key=&#123;n&#125;</span><br><span class="line">                    /&gt;</span><br><span class="line">                )</span><br><span class="line">            &#125;</span><br><span class="line">            &lt;div&gt;count: &#123;count&#125;&lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">        &lt;/</span>div&gt;</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<p>æ”¹å†™åçš„å­ç»„ä»¶</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> Num = React.memo(<span class="function">(<span class="params">&#123; increment, n &#125;</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// ä»¥ä¸‹ä¸¤å¥ç”¨æ¥æŸ¥çœ‹ç»„ä»¶æ›´æ–°çš„æ¬¡æ•°</span></span><br><span class="line">    <span class="keyword">const</span> renderCount = useRef(<span class="number">0</span>)</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'render count:'</span>, renderCount.current++)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> &lt;button onClick=&#123;() =&gt; &#123;increment(n)&#125;&#125;&gt;&#123;n&#125;&lt;/button&gt;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>


          
      </div>
    <footer class="article-footer">
      <a data-url="http://miaomiaoxuan.cn/2020/01/13/useCallbackä½¿ç”¨åœºæ™¯/" data-id="ckb0ezkeo00051k6ofqhlaovm" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2020/01/29/å¼‚æ­¥å’ŒPromiseæ‰§è¡Œè¿‡ç¨‹å›¾è§£/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          å¼‚æ­¥å’ŒPromiseæ‰§è¡Œè¿‡ç¨‹å›¾è§£
        
      </div>
    </a>
  
  
</nav>

  
</article>


</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">åˆ†ç±»</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/JavaScript/">JavaScript</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/React/">React</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/git/">git</a></li></ul>
    </div>
  </div>


  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">å½’æ¡£</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/05/">äº”æœˆ 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/04/">å››æœˆ 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/03/">ä¸‰æœˆ 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/02/">äºŒæœˆ 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/01/">ä¸€æœˆ 2020</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">æœ€æ–°æ–‡ç« </h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2020/05/03/è¿›ç¨‹å’Œçº¿ç¨‹-ç™½è¯ç‰ˆ/">è¿›ç¨‹å’Œçº¿ç¨‹(ç™½è¯ç‰ˆ)</a>
          </li>
        
          <li>
            <a href="/2020/04/04/å¹¿å‘Šè¡Œä¸šæ¦‚å¿µæ‰«ç›²/">å¹¿å‘Šè¡Œä¸šæ¦‚å¿µåŠæŒ‡æ ‡æ‰«ç›²</a>
          </li>
        
          <li>
            <a href="/2020/03/07/container/">container åŸºæœ¬åŸç†</a>
          </li>
        
          <li>
            <a href="/2020/02/17/useRefä½¿ç”¨åœºæ™¯è¯´æ˜å’Œä¸¾ä¾‹/">useRefä½¿ç”¨åœºæ™¯è¯´æ˜å’Œä¸¾ä¾‹</a>
          </li>
        
          <li>
            <a href="/2020/02/17/git-checkout-reset-revert-clean-åŒºåˆ«/">git checkout/reset/revert/clean åŒºåˆ«</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2020 Superå–µå–µç„<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>



  </div>
</body>
</html>